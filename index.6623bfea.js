import{r as e,w as t,d as a,a as n,o as r,c as l,b as i,u as s,t as o,e as c,f as d,g,h as m,F as u,i as p}from"./vendor.6d10ebd0.js";const h=e((e=>{var t;try{return null!=(t=JSON.parse(localStorage.getItem(e)||""))?t:void 0}catch{return}})("state")||{version:1,settings:{backgroundImage:{filename:null,payload:null},topLeftImage:{filename:null,payload:null},topCenterImage:{filename:null,payload:null},topRightImage:{filename:null,payload:null}},cards:{}});t((()=>{return e="state",t=h,void localStorage.setItem(e,JSON.stringify(t,null,2));var e,t}));var f=a({props:{src:{type:null,required:!1}},setup(e){const t=e,a=n(),i=()=>{requestAnimationFrame(i),(()=>{if(!t.src)return;const e=a.value;if(!e)return;const n=e.getContext("2d"),r=e.parentElement,l=r.clientWidth/r.clientHeight>t.src.width/t.src.height?r.clientHeight/t.src.height:r.clientWidth/t.src.width;e.width=t.src.width*l,e.height=t.src.height*l,n.imageSmoothingEnabled=!1,n.drawImage(t.src,0,0,t.src.width,t.src.height,0,0,e.width,e.height)})()};return requestAnimationFrame(i),(e,t)=>(r(),l("canvas",{ref:a,class:"image-rendering-pixelated mx-auto"},null,512))}});const v={},w=e=>new Promise(((t,a)=>{if(!e)return t(null);if(e in v)return t(v[e]);const n=document.createElement("img"),r=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),v[e]=n,t(n)},l=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),a()};n.addEventListener("load",r),n.addEventListener("error",l),n.src=e})),b={class:"w-full flex-shring overflow-hidden m-16"};var x=a({props:{scale:{type:Number,required:!1}},setup(e){const{scale:a=32}=e,n=document.createElement("canvas"),o=n.getContext("2d");return t((async()=>{const[e,t,r,l]=await Promise.all([w(h.settings.backgroundImage.payload),w(h.settings.topLeftImage.payload),w(h.settings.topCenterImage.payload),w(h.settings.topRightImage.payload)]);o.clearRect(0,0,n.width,n.height),e&&(n.width=e.width*a,n.height=e.height*a,o.imageSmoothingEnabled=!1,o.drawImage(e,0,0,e.width,e.height,0,0,n.width,n.height)),t&&o.drawImage(t,0,0,t.width,t.height,6*a,6*a,t.width*a,t.height*a),r&&o.drawImage(r,0,0),l&&o.drawImage(l,0,0,l.width,l.height,n.width-6*a-l.width*a,6*a,l.width*a,l.height*a)})),(e,t)=>(r(),l("div",b,[i(f,{src:s(n)},null,8,["src"])]))}});const y={class:"border-2 rounded pb-2 px-2"};var I=a({props:{label:{type:String,required:!0}},setup(e){const t=e;return(e,a)=>(r(),l("fieldset",y,[i("legend",null,o(t.label),1),c(e.$slots,"default")]))}});const L=i("ul",null,null,-1);var E=a({setup:e=>(e,t)=>(r(),l(I,{class:"flex-grow border-2 overflow-auto",label:"Cards"},{default:d((()=>[L])),_:1}))}),S=a({setup:e=>(e,t)=>(r(),l(I,{class:"flex-grow w-96",label:"{{ Card Title }}"}))});const k={},C={class:"bg-center bg-contain bg-no-repeat image-rendering-pixelated h-16 flex-shrink-0",src:"./assets/logo.png",alt:"Victorum"};k.render=function(e,t){return r(),l("img",C)};const R=i("img",{class:"h-5",src:"./assets/icon-image-upload.svg","aria-hidden":""},null,-1);var q=a({props:{label:{type:String,required:!0},filename:{type:[String,null],required:!1}},emits:["upload"],setup(e,{emit:t}){const a=e,n=e=>{const a=Array.from(e||[]).find((e=>e.type.startsWith("image/")));a&&t("upload",a)},s=e=>{var t;n(null==(t=e.dataTransfer)?void 0:t.files)},c=e=>{const t=e.target;n(t.files),t.value=""};return(e,t)=>(r(),l("label",{class:"cursor-pointer",onDragenter:t[1]||(t[1]=m((()=>{}),["prevent"])),onDragover:t[2]||(t[2]=m((()=>{}),["prevent"])),onDrop:m(s,["prevent"])},[g(o(a.label)+": ",1),i("div",{title:`Upload a ${a.label}`,class:"x-focus-within p-2 items-center justify-between flex flex-row border-2 rounded"},[g(o(a.filename||"None")+" ",1),R,i("input",{class:"x-visually-hidden",onChange:c,type:"file",accept:"image/*"},null,32)],8,["title"])],40,["onDrop"]))}});const U=e=>new Promise(((t,a)=>{const n=new FileReader,r=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),t(n.result)},l=()=>{n.removeEventListener("load",r),n.removeEventListener("error",l),a(n.error)};n.addEventListener("load",r),n.addEventListener("error",l),n.readAsDataURL(e)}));var j=a({setup(e){const t=e=>c("backgroundImage",e),a=e=>c("topLeftImage",e),n=e=>c("topCenterImage",e),o=e=>c("topRightImage",e),c=async(e,t)=>{h.settings[e]={filename:t.name,payload:await U(t)}};return(e,c)=>(r(),l(I,{class:"flex flex-col gap-2 flex-grow w-96",label:"Settings"},{default:d((()=>[i(q,{label:"Background Image",filename:s(h).settings.backgroundImage.filename,onUpload:t},null,8,["filename"]),i(q,{label:"Top Left Image",filename:s(h).settings.topLeftImage.filename,onUpload:a},null,8,["filename"]),i(q,{label:"Top Center Image",filename:s(h).settings.topCenterImage.filename,onUpload:n},null,8,["filename"]),i(q,{label:"Top Right Image",filename:s(h).settings.topRightImage.filename,onUpload:o},null,8,["filename"])])),_:1}))}});const D={class:"align-middle"};var O=a({props:{label:{type:String,required:!0},icon:{type:String,required:!0}},emits:["click"],setup(e,{emit:t}){const a=e;return(e,n)=>(r(),l("button",{class:"flex flex-row gap-1 items-center min-w-max p-2 border-2 rounded x-focus",onClick:n[1]||(n[1]=()=>t("click"))},[i("img",{src:a.icon,class:"h-5 inline","aria-hidden":""},null,8,["src"]),i("span",D,o(a.label),1)]))}});var N=a({setup(e){const t=async()=>{const e=await((e="text/plain")=>new Promise((t=>{const a=document.createElement("input");a.type="file",a.accept=e,a.multiple=!0;const n=()=>{a.removeEventListener("change",n),t(a.files[0])};a.addEventListener("change",n),a.click()})))("application/json"),t=await e.text(),a=JSON.parse(t);Object.assign(h,a)},a=()=>{((e,t,a="text/plain")=>{const n=new Blob([t],{type:a}),r=URL.createObjectURL(n),l=document.createElement("a");l.href=r,l.download=e,l.click(),queueMicrotask((()=>{URL.revokeObjectURL(r)}))})(`victorum-cards-${(new Date).getFullYear()}${(new Date).getMonth().toString().padStart(2,"0")}${(new Date).getDate().toString().padStart(2,"0")}.json`,JSON.stringify(h,null,2),"application/json")};return(e,n)=>(r(),l(I,{class:"flex flex-row items-center justify-around",label:"Share"},{default:d((()=>[i(O,{label:"Import",icon:"/assets/icon-import.svg",onClick:t}),i(O,{label:"Export",icon:"/assets/icon-export.svg",onClick:a})])),_:1}))}});const F={class:"m-0 p-4 h-full w-96 flex flex-col gap-4 flex-shrink-0"},T={class:"flex flex-col p-4 gap-4 flex-shrink-0"};var $=a({setup:e=>(e,t)=>(r(),l(u,null,[i("menu",F,[i(k),i(E),i(N)]),i(x),i("main",T,[i(j),i(S)])],64))});addEventListener("load",(()=>{p($).mount("#app")}));
